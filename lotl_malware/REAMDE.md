# **Living off the land malware（离地攻击）**

### 本文件夹中的文章聚焦于采用了LOTL（离地攻击）技术的恶意软件，以Windows平台的PE文件为主。包括该类型恶意软件的检测以及规避技术的探索。


#### 1. 2022/9/25 Living-off-the-Land Abuse Detection Using Natural Language Processing and Supervised Learning
+ 概述：arxiv上的一篇论文，对离地攻击的命令进行检测，许多细节没交代清楚，但是解决的问题比较新颖。实验做的也比较简陋。
+ 主要工作：利用监督学习和自然语言处理的方法，对LOLBin命令进行检测，判别是否存在潜在的恶意行为。
+ 方法：利用自然语言处理的技术处理命令样本，生成词单元然后进行独热编码。利用神经网络(MLP)、随机森林(RF)方法进行监督学习，在阵势场景下进行验证。
+ 数据集：对离地攻击进行检测，以区别合法的命令。从[LOLBAS](https://lolbas-project.github.io/)获取了一些常见的离地攻击命令，然后从终端获取合法的命令(没交代清楚)，构建了数据集包含正常和异常样本大约500条。
+ 创新点：1)训练多个模型检测不同的LOLBin; 2)对命令向量化提出了特殊方法。
+ 不足：数据样本太少，而且仅针对特定的LOLBin进行检测，比较局限。


#### 2. 2022/9/26 Analysis of Fileless Malware and its Evasive Behavior
+ 概述：这篇文章介绍了Fileless Malware（与离地攻击差不多意思）的主要步骤。包括如何渗透目标主机, 如何执行相应恶意载荷。还包括了无文件攻击的主要技术，以及建议的防御方法。
+ 主要工作：介绍了无文件攻击的主要步骤。简要给出了攻击技术，还有可行的防御方法。
+ 方法：归纳总结。
+ 数据集：介绍性文章，没有实验。
+ 创新点：点分的细。
+ 不足：无。

#### 3. 2022/9/27 NLP-based Entity Behavior Analytics forMalware Detection
+ 概述：本文利用进程行为分析的方式，对系统监控日志进行了分析。将系统中进程的行为以有向无环图表示。再将其转为文档的形式，利用自然语言处理的技术Doc2Vec将文档向量化。基于异常检测方法对向量化以后的文档进行检测，确定恶意行为。在真实场景下验证准确率可达0.94。
+ 主要工作：利用自然语言处理的方法，将系统日志数据转换为文档再进行向量化，进行异常检测。
+ 方法：图生成，图嵌入，文档向量化以及异常检测。
+ 数据集：自己从公司内网收集的，为日志数据（由Sysmon 软件产生），约3TB。
+ 创新点：采用了自然语言处理的技术， 将进程的执行描述为有向无环图再转换成文档。
+ 不足：有的地方没有交代清楚，不好复现和比较。

#### 4. 2022/9/27 Runtime API Signature for FilelessMalware Detection
+ 概述：针对无文件攻击（离地攻击）隐蔽性高，无实体进行静态检测，且检测难的问题。作者对恶意行为进行分析，借助运行时的API调用，并提出了一种规则（API签名，动态签名）来识别恶意行为。
+ 主要工作：提出了一种行的动态检测规则。根据进程的API调用生成动态签名以识别恶意行为。
+ 方法：将DLL注入到进程中来记录调用的API。
+ 数据集：无。
+ 创新点：提出了一种名叫动态签名的方法来表征恶意软件行为（Runtime API Signature）。
+ 不足：工作量小，更像是实验报告。

#### 5. 2022/9/29 An emerging threat Fileless malware: asurvey and research challenges
+ 概述：综述文章，介绍了无文件攻击（离地攻击）的感染机制，攻击中常用的合法工具，常见的无文件攻击样本以及研究挑战。
+ 主要工作：介绍了一些无文件攻击的定义，典型行为以及常见的防御策略。
+ 方法：归纳总结。
+ 数据集：无数据集。
+ 创新点：有些检测方法可以借鉴。
+ 不足：综述类不好评价，内容不太充实。

#### 6. 2022/9/29 An Approach to Detect Fileless Malware and  Defend its Evasive mechanisms 
+ 概述：没有实验和方法，主要以介绍为主。介绍了无文件攻击的步骤，无文件攻击的分类，无文件攻击的规避技术以及潜在的防御方法。
+ 主要工作：作者将无文件攻击的步骤分为4步，分别是投递阶段、持久化阶段、执行阶段以及最终的目标实现。将无文件攻击恶意软件分为基于内存的和基于脚本的。在规避手法上，作者将其分成了恶意文档，恶意脚本，离地攻击二进制以及内存中的恶意代码。最后在检测方法上，作者给出了如沙盒、仿真、启发式以及YARA规则等几种检测方法。
+ 方法：归纳总结。
+ 数据集：无数据集。
+ 创新点：YARA规则可以学习下。
+ 不足：不好评价，没有实验。


### References
[4 种常见“无文件”攻击技术解析](https://zhuanlan.zhihu.com/p/49563271)
